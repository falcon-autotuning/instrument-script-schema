{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://falcon.io/schemas/instrument-configuration.json",
  "title": "Instrument Configuration ",
  "description": "Schema for specifying a concrete instrument instance to be started on the server. References an instrument API definition and provides connection details.",
  "type": "object",
  "required": [
    "name",
    "api_ref",
    "connection"
  ],
  "properties": {
    "name": {
      "type": "string",
      "pattern": "^[A-Z][A-Z0-9_]*$",
      "description": "**Instrument Name** (required, string)\n\nUnique identifier for this instrument instance (e.g., 'SMU1')."
    },
    "api_ref": {
      "type": "string",
      "description": "**API Reference** (required, string)\n\nPath or URI to the instrument API definition (instrument-api.json) for this instrument type."
    },
    "connection": {
      "type": "object",
      "description": "**Connection Details** (required, object)\n\nHow to access this instrument on the system.",
      "required": [
        "type"
      ],
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "VISA",
            "Serial",
            "USB",
            "Custom"
          ],
          "description": "**Connection Type** (required, string)\n\nHow to connect: 'VISA', 'Serial', 'USB', or 'Custom'."
        },
        "address": {
          "type": "string",
          "description": "**Address** (optional, string)\n\nVISA resource string, serial port, USB path, or custom address."
        },
        "baudrate": {
          "type": "integer",
          "description": "**Baudrate** (optional, integer)\n\nSerial baudrate if using serial connection."
        },
        "custom": {
          "type": "object",
          "description": "**Custom Connection Info** (optional, object)\n\nAdditional fields for custom connection types.",
          "additionalProperties": true
        }
      },
      "additionalProperties": false
    },
    "startup": {
      "type": "object",
      "description": "**Startup Options** (optional, object)\n\nAdditional startup configuration (e.g., initialization commands, delays).",
      "properties": {
        "init_commands": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "**Initialization Commands** (optional, array)\n\nCommands to send on startup."
        },
        "delay_ms": {
          "type": "integer",
          "description": "**Startup Delay** (optional, integer)\n\nDelay in milliseconds after connecting before use."
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
